<div id='preview-contents' class='note-content'>
                        
                    



<h3 id="æ·±å…¥nodebuffer">æ·±å…¥ï¼šNodeï¼šBuffer</h3>

<p></p>



<h4 id="ä¸€å‰è¨€">ä¸€ã€å‰è¨€ï¼š</h4>

<blockquote>
  <p>ç¼“å­˜ï¼›è¡¨ç°ä¸º16è¿›åˆ¶ <br>
  âš ï¸æ³¨æ„ï¼šä¸è¦ç”¨new</p>
</blockquote>

<ul><li><p>è¡¨ç°å½¢å¼ï¼š <br>
<code>utf8(ä¸‰ä¸ªå­—èŠ‚)ã€gbkã€gb2312(ä¸¤ä¸ª)</code> <br>
<br></p></li>
<li><p>çŸ¥è¯†ç‚¹ï¼š <br>
1b=8bit <br>
äºŒè¿›åˆ¶ï¼š11111111 -&gt; 255  æœ€å¤§ <br>
å…«è¿›åˆ¶ï¼š377 <br>
åå…­è¿›åˆ¶ï¼šff <br>
<br></p></li>
<li><p>è½¬æ¢æ–¹æ³•ï¼š <br>
<code>from</code>ï¼šæŠŠå­—ç¬¦è½¬æ¢æˆ16è¿›åˆ¶ <br>
<code>buffer.toString('base64')</code>ï¼šBufferè½¬ä¸ºbase64 <br>
<code>parseInt('11111111',2)</code>ï¼š2è¿›åˆ¶è½¬ä¸ºä¸º10è¿›åˆ¶ <br>
<code>(255).toString(16)</code>ï¼š10è¿›åˆ¶è½¬åŒ–ä¸º16è¿›åˆ¶ï¼8è¿›åˆ¶ï¼2è¿›åˆ¶</p></li>
</ul>

<blockquote>
  <p>å…³äºbase64 <br>
  ä¸€åˆ‡èƒ½é˜²æ­¢è·¯å¾„çš„åœ°æ–¹ï¼Œéƒ½å¯ä»¥ä½¿ç”¨base64ï¼›å¦‚<code>img.src background</code></p>
</blockquote>



<h4 id="äºŒbufferfrom">äºŒã€Buffer.from</h4>

<ul><li><p><code>0x</code>è¡¨ç¤º16è¿›åˆ¶</p></li>
</ul>



<pre class="prettyprint hljs-dark"><code class="language-javascript hljs"><div class="hljs-line"><span class="hljs-keyword">const</span> r=Buffer.from(<span class="hljs-string">'ç™½'</span>);<span class="hljs-comment">//&lt;Buffer e7 99 bd&gt;</span>
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log((<span class="hljs-number">0xe7</span>).toString(<span class="hljs-number">2</span>));
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log((<span class="hljs-number">0x99</span>).toString(<span class="hljs-number">2</span>));
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log((<span class="hljs-number">0xbd</span>).toString(<span class="hljs-number">2</span>));
</div><div class="hljs-line"><span class="hljs-comment">//11100111</span>
</div><div class="hljs-line"><span class="hljs-comment">//10011001</span>
</div><div class="hljs-line"><span class="hljs-comment">//10111101</span>
</div><div class="hljs-line"><span class="hljs-keyword">let</span> str = <span class="hljs-string">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span>;
</div><div class="hljs-line">str+= str.toLowerCase();
</div><div class="hljs-line">str += <span class="hljs-string">'0123456789+/'</span>;
</div><div class="hljs-line"><span class="hljs-comment">// åŠ å¯†çš„è¿‡ç¨‹ md5  base64åªæ˜¯ç¼–ç </span>
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log(str[<span class="hljs-number">57</span>]+str[<span class="hljs-number">56</span>]+str[<span class="hljs-number">62</span>]+str[<span class="hljs-number">32</span>]); <span class="hljs-comment">// ç†è®ºä¸Šå¤§1/3</span>
</div></code></pre>



<h4 id="ä¸‰bufferçš„å£°æ˜æ–¹å¼">ä¸‰ã€Bufferçš„å£°æ˜æ–¹å¼</h4>

<ul><li><p><code>Buffer.from('å¤§ç™½')</code>ï¼šè½¬æˆ16è¿›åˆ¶ï¼Œå­—ç¬¦ä¸² <br>
âš ï¸æ³¨æ„ï¼šè¿™é‡Œä¸èƒ½æ˜¯æ•°å­—æ ¼å¼</p></li>
<li><p><code>Buffer.alloc(3)</code>ï¼šåˆ†é…å†…å­˜</p></li>
<li><p><code>Buffer.from([255,255,255])</code>ï¼šè½¬æˆ16è¿›åˆ¶ï¼Œæ•°ç»„</p></li>
</ul>

<p>âš ï¸æ³¨æ„ï¼šbufferä¸€æ—¦å£°æ˜ å°±ä¸èƒ½å¢åŠ é•¿åº¦ copy + concat + split</p>



<pre class="prettyprint hljs-dark"><code class="language-javascript hljs"><div class="hljs-line"><span class="hljs-keyword">let</span> buffer =  Buffer.from(<span class="hljs-string">'å¤§ç™½'</span>);
</div><div class="hljs-line"><span class="hljs-keyword">let</span> buffer1 = Buffer.alloc(<span class="hljs-number">3</span>);
</div><div class="hljs-line"><span class="hljs-keyword">let</span> buffer2 = Buffer.from([<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>]);
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log(buffer2);
</div></code></pre>

<p>copyæ–¹æ³•ï¼š</p>



<pre class="prettyprint hljs-dark"><code class="language-javascript hljs"><div class="hljs-line">b1.copy(big,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">3</span>);
</div><div class="hljs-line">b2.copy(big,<span class="hljs-number">3</span>,<span class="hljs-number">0</span>,<span class="hljs-number">3</span>);
</div></code></pre>



<h4 id="å››æ€è€ƒ">å››ã€æ€è€ƒ</h4>

<p>ğŸ˜”æ€è€ƒï¼šè‡ªå·±å®ç°ä¸€ä¸ªconcatæ–¹æ³• <br>
(è‡ªå·±å†™çš„)</p>



<pre class="prettyprint hljs-dark"><code class="language-javascript hljs"><div class="hljs-line"><span class="hljs-built_in">Function</span>.prototype.con=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">...arg</span>)</span>{
</div><div class="hljs-line">    <span class="hljs-comment">//è®¡ç®—æ–°çš„buferå†…å­˜ï¼Œå¹¶ä¸”èµ‹å€¼å†…å­˜</span>
</div><div class="hljs-line">    <span class="hljs-keyword">let</span> alloc=<span class="hljs-number">0</span>;
</div><div class="hljs-line">    arg.forEach(<span class="hljs-function"><span class="hljs-params">item</span>=&gt;</span>{
</div><div class="hljs-line">        <span class="hljs-keyword">if</span>(item <span class="hljs-keyword">instanceof</span> Buffer){
</div><div class="hljs-line">            alloc+=item.length;
</div><div class="hljs-line">        }<span class="hljs-keyword">else</span>{
</div><div class="hljs-line">            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'è¯·ä¼ Bufferæ ¼å¼æ•°æ®'</span>);
</div><div class="hljs-line">        }
</div><div class="hljs-line"><wbr>
</div><div class="hljs-line">    });
</div><div class="hljs-line">    alloc=Buffer.alloc(alloc);
</div><div class="hljs-line"><wbr>
</div><div class="hljs-line">    <span class="hljs-comment">//ç”¨copyæ–¹æ³•åˆå¹¶èµ‹å€¼</span>
</div><div class="hljs-line">    <span class="hljs-keyword">let</span> buf,len=<span class="hljs-number">0</span>;
</div><div class="hljs-line">    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i=<span class="hljs-number">0</span>;i&lt;arg.length;i++){
</div><div class="hljs-line">        <span class="hljs-keyword">const</span> curBuf=arg[i];
</div><div class="hljs-line">        curBuf.copy(alloc,len,<span class="hljs-number">0</span>,curBuf.length);
</div><div class="hljs-line">        len=curBuf.length;
</div><div class="hljs-line">    }
</div><div class="hljs-line">    <span class="hljs-keyword">return</span> alloc;
</div><div class="hljs-line">}
</div><div class="hljs-line"><span class="hljs-keyword">let</span> a=Buffer.from(<span class="hljs-string">'å¤§'</span>);
</div><div class="hljs-line"><span class="hljs-keyword">let</span> b=Buffer.from(<span class="hljs-string">'ç™½'</span>);
</div><div class="hljs-line"><span class="hljs-keyword">const</span> res=Buffer.con(a,<span class="hljs-string">'wer'</span>);
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log(res.toString());
</div></code></pre></div>